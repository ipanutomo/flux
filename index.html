<!DOCTYPE html>
<html>
<head>
    <title>AI Image Generator Pro</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;padding:20px}
        .container{max-width:900px;margin:0 auto;background:white;border-radius:15px;padding:30px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
        h1{text-align:center;color:#333;margin-bottom:30px;font-size:2.5em}
        textarea{width:100%;padding:15px;border:2px solid #ddd;border-radius:8px;font-size:16px;resize:vertical;min-height:80px}
        textarea:focus{outline:none;border-color:#667eea}
        button{padding:15px 25px;background:#667eea;color:white;border:none;border-radius:8px;font-size:16px;cursor:pointer}
        button:disabled{opacity:0.6;cursor:not-allowed}
        .loading{color:#667eea;font-size:18px;padding:20px}
        .error{color:#e74c3c;background:#fdf0f0;padding:15px;border-radius:8px;border-left:4px solid #e74c3c}
        .generated-image{max-width:100%;border-radius:8px;box-shadow:0 5px 15px rgba(0,0,0,.1)}
        .chip{background:#e9ecef;padding:8px 16px;border-radius:30px;font-size:0.9em;cursor:pointer;margin:5px;display:inline-block}
    </style>
</head>
<body>
<div class="container">
    <h1>AI Image Generator Pro</h1>

    <div style="margin-bottom:20px">
        <div style="font-weight:600;margin-bottom:8px">Positive Prompt</div>
        <textarea id="positive" placeholder="cyberpunk cat with neon glasses, highly detailed..."></textarea>
    </div>

    <div style="margin-bottom:20px">
        <div style="font-weight:600;margin-bottom:8px">Negative Prompt (optional)</div>
        <textarea id="negative" placeholder="blurry, ugly, deformed, watermark, text"></textarea>
    </div>

    <div style="margin-bottom:20px">
        <span class="chip" onclick="setPrompt('cyberpunk cat with neon glasses','blurry, ugly')">Cyber Cat</span>
        <span class="chip" onclick="setPrompt('snow cat in winter forest','')">Snow Cat</span>
        <span class="chip" onclick="setPrompt('anime girl with cat ears, kawaii style','realistic, photo')">Anime Cat Girl</span>
        <span class="chip" onclick="setPrompt('indomie goreng with extra egg, realistic food photo','cartoon, blurry')">Indomie Legend</span>
    </div>

    <button id="btn" onclick="generate()">Generate with Playground v2.5</button>
    <div id="result"></div>
</div>

<script>
    const WORKER_URL = 'https://sd3-unlimited.ipanutomo.workers.dev';
    
    function setPrompt(pos, neg) {
        document.getElementById('positive').value = pos;
        document.getElementById('negative').value = neg;
    }

    async function generate() {
        const pos = document.getElementById('positive').value.trim();
        const neg = document.getElementById('negative').value.trim();
        const btn = document.getElementById('btn');
        const result = document.getElementById('result');

        if (!pos) return alert('Prompt harus diisi!');

        btn.disabled = true;
        btn.textContent = 'Generating... (10-15 detik)';
        result.innerHTML = '<div class="loading">Playground v2.5 sedang melukis aesthetic art...</div>';

        // FIX: Kirim sebagai JSON biar ga ribet header (worker tetep nerima sebagai form, tapi fallback JSON)
        const payload = { prompt: pos + (neg ? ` --no ${neg}` : "") };
        const res = await fetch(WORKER_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },  // Tambah ini biar aman
            body: JSON.stringify(payload)
        });

        if (!res.ok) {
            const err = await res.json();
            throw new Error(err.error || 'Server error');
        }

        const blob = await res.blob();
        const url = URL.createObjectURL(blob);
        result.innerHTML = `
            <img src="${url}" class="generated-image">
            <br><br>
            <a href="${url}" download="playground-${Date.now()}.png" style="background:#27ae60;color:white;padding:12px 24px;border-radius:8px;text-decoration:none;font-weight:bold">
                Download 1024Ã—1024
            </a>
            <p style="margin-top:15px;color:#666;font-size:0.9em">
                Prompt: ${pos}<br>
                ${neg ? 'Negative: ' + neg : ''}
            </p>
        `;
        btn.disabled = false;
        btn.textContent = 'Generate with Playground v2.5';
    }
</script>
</body>
</html>
